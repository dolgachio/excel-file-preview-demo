{"version":3,"sources":["components/WorkbookGrid/GridSelector/GridSelector.jsx","components/WorkbookGrid/CellValueInput/CellValueInput.jsx","components/WorkbookGrid/useCellValue.hook.js","components/WorkbookGrid/x-spreadsheet/ExcelXSpreadSheet.jsx","components/WorkbookGrid/ag-grid/getColumnDefs.js","components/WorkbookGrid/SheetsSelector/SheetsSelector.jsx","components/WorkbookGrid/ag-grid/ExcelAgGrid.jsx","utils/xlsxToJson.js","components/WorkbookGrid/WorkbookGrid.jsx","components/ExcelPreview/ExcelPreview.js"],"names":["GridSelector","gridOptions","onGridOptionChange","selectedGridOptionName","options","reduce","result","option","isSelected","name","radio","key","type","onChange","value","checked","link","className","href","rel","target","radios","push","links","length","CellValueInput","cellValue","onCellDataRequest","useState","cellName","setCellName","onSubmit","event","preventDefault","htmlFor","useCellValue","workbook","setCellValue","useCallback","firstSheetName","SheetNames","firstSheet","Sheets","normalizedCellName","trim","toUpperCase","v","ExcelXSpreadSheet","gridContainerRef","useRef","out","useMemo","forEach","o","rows","Sheet","XLSX","utils","sheet_to_json","raw","header","r","i","cells","c","j","text","useEffect","current","innerHTML","mode","showToolbar","view","height","clientHeight","width","clientWidth","Spreadsheet","loadData","ref","getColumnDefs","rowData","columnFields","Set","row","Object","keys","add","columnFieldsArray","Array","from","sort","headerName","valueGetter","node","rowIndex","pinned","map","columnName","field","SheetsSelector","onSheetNameChange","sheetName","SheetsNames","onClick","ExcelAgGrid","setActiveSheetName","blankrows","cellStyles","xlsxToJson","columnDefs","defaultColDef","GridsEnum","WorkBookGrid","selectGridOptionName","ExcelPreview","setWorkbook","onFileChange","files","file","reader","FileReader","onload","data","Uint8Array","read","SheetName","readAsArrayBuffer","accept"],"mappings":"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","file":"static/js/3.6dc1f281.chunk.js","sourcesContent":["import React from 'react';\n\nimport './GridSelector.css';\n\nfunction GridSelector({ gridOptions, onGridOptionChange, selectedGridOptionName }) {\n\n    let options = gridOptions.reduce((result, option) => {\n        let isSelected = selectedGridOptionName === option.name;\n\n        let radio = (\n        <label key={option.name}>\n            <input type=\"radio\"\n                onChange={onGridOptionChange} \n                name=\"grid-option\" value={option.name} \n                checked={isSelected}/> <b>{option.name}</b>\n        </label>\n        );\n\n        let link = (<a className=\"grid-selector__link\" key={option.name} href={option.link} rel=\"noopener noreferrer\" target=\"_blank\">{option.name}</a>);\n\n        result.radios.push(radio);\n        result.links.push(link);\n\n        return result;\n    }, { radios: [], links: [] });\n\n    return (\n    <div className=\"grid-selector\">\n        <p>\n            We use {options.links.length} different libraries for displaying data. Here you can find links to them: {options.links}.\n        </p>\n        <p>\n            For parsing files we use the <a href=\"https://github.com/SheetJS/sheetjs\" rel=\"noopener noreferrer\" target=\"_blank\">SheetJS</a>\n        </p>\n        \n        {options.radios}\n    </div>\n    )\n};\n\nexport default GridSelector;","import React, { useState } from 'react';\r\n\r\nimport './CellValueInput.css';\r\n\r\nfunction CellValueInput({ cellValue, onCellDataRequest }) {\r\n    let [ cellName, setCellName ] = useState('');\r\n\r\n    return (\r\n    <form onSubmit={(event) => {event.preventDefault(); onCellDataRequest(cellName);}} className=\"cell-value-input\">\r\n        <div>Get Value From The Cell</div>\r\n\r\n        <p>\r\n            We get values from the FIRST SHEET from the file.\r\n        </p>\r\n\r\n        <div className=\"cell-value-input__field\">\r\n            <label htmlFor=\"cell-name\">Cell Name (A1, B2, C3 etc): </label>\r\n            <input name=\"cell-name\" type=\"text\" value={cellName}\r\n                onChange={(event) => setCellName(event.target.value)}/>\r\n        </div>\r\n\r\n        <button type=\"submit\">Get Cell Value</button>\r\n\r\n        <div className=\"cell-value-input__cell-value\">\r\n            The cell value is: <b>{cellValue || 'Cell value is not available or empty...'}</b>\r\n        </div>\r\n    </form>\r\n    )\r\n}\r\n\r\nexport default CellValueInput;","import { useState, useCallback } from 'react';\r\n\r\nexport function useCellValue(workbook) {\r\n    let [cellValue, setCellValue] = useState(null);\r\n\r\n    let onCellDataRequest = useCallback((cellName) => {\r\n        let [firstSheetName] = workbook.SheetNames;\r\n        let firstSheet = workbook.Sheets[firstSheetName];\r\n        let normalizedCellName = cellName.trim().toUpperCase();\r\n\r\n        setCellValue(firstSheet[normalizedCellName]?.v);\r\n    }, [workbook, setCellValue]);\r\n\r\n    return [cellValue, onCellDataRequest];\r\n}","import React, { useRef, useMemo, useEffect } from 'react';\n\nimport XLSX from 'xlsx';\nimport Spreadsheet  from 'x-data-spreadsheet';\n\nimport '../../../../node_modules/x-data-spreadsheet/dist/xspreadsheet.css';\n\nimport './ExcelXSpreadSheet.css';\n\nimport CellValueInput from '../CellValueInput/CellValueInput';\nimport { useCellValue } from '../useCellValue.hook';\n\nfunction ExcelXSpreadSheet({ workbook }) {\n    let [cellValue, onCellDataRequest] = useCellValue(workbook);\n    \n    let gridContainerRef = useRef(null);\n\n    let out = useMemo(() => {\n        let out = [];\n        workbook.SheetNames.forEach((name) => {\n          let o = { name:name, rows:{} };\n          let Sheet = workbook.Sheets[name];\n          let SheetJson = XLSX.utils.sheet_to_json(Sheet, {raw: false, header:1});\n          \n          SheetJson.forEach((r, i) => {\n            let cells = {};\n            r.forEach(function(c, j) { cells[j] = ({ text: c }); });\n            o.rows[i] = { cells: cells };\n          })\n          out.push(o);\n        });\n        \n        return out;\n    }, [workbook]);\n\n    useEffect(() => {\n        let grid;\n        if (!gridContainerRef.current) {\n            return;\n        } \n\n        gridContainerRef.current.innerHTML = '';\n        let options = { \n            mode: 'read',\n            showToolbar: false,\n            view: {\n                height: () => gridContainerRef.current.clientHeight,\n                width: () => gridContainerRef.current.clientWidth,\n            },\n        };\n        \n        grid = new Spreadsheet(gridContainerRef.current, options);\n\n        grid.loadData(out);\n    }, [out]);\n\n    return (\n    <div className=\"excel-x-spreadsheet\">\n        <h2>X-spreadsheet Rendering version</h2>\n\n        <CellValueInput cellValue={cellValue} onCellDataRequest={onCellDataRequest} />\n    \n        <div ref={gridContainerRef} className=\"excel-x-spreadsheet-grid-container\"></div>\n    </div>\n    );\n}\n\nexport default ExcelXSpreadSheet;","export function getColumnDefs(rowData) {\n    let columnFields = new Set();\n\n    let numbersColumn = {\n        headerName: '',\n        valueGetter(rowData) {\n            return rowData.node.rowIndex;\n        },\n        pinned: true,\n        width: 50\n    }\n\n    rowData.forEach((row) => {\n        let keys = Object.keys(row);\n        keys.forEach((key) => columnFields.add(key));\n    });\n\n    let columnFieldsArray = Array.from(columnFields).sort();\n\n    return [numbersColumn, ...columnFieldsArray.map((columnName) => ({ field: columnName, headerName: columnName }))];\n}","import React, { useMemo } from 'react';\n\nimport './SheetsSelector.css';\n\nfunction SheetsSelector({ SheetNames, onSheetNameChange, sheetName }) {\n    let SheetsNames = useMemo(() => SheetNames\n        .map((name) => (<button \n            className={`sheets-selector__button ${name === sheetName && 'sheets-selector__button_active'}`} \n            key={name} \n            name={name} \n            onClick={onSheetNameChange}>{name}</button>)), \n        [SheetNames, onSheetNameChange, sheetName]);\n\n    return (\n    <div className=\"sheets-selector\">\n        <h2>Sheets: </h2>\n        {SheetsNames}\n    </div>\n    );\n}\n\nexport default SheetsSelector;","import React, { useMemo, useState, useCallback } from 'react';\n\nimport { AgGridReact } from 'ag-grid-react';\n\nimport 'ag-grid-community/dist/styles/ag-grid.css';\nimport 'ag-grid-community/dist/styles/ag-theme-alpine.css';\nimport './ExcelAgGrid.css';\n\nimport { getColumnDefs } from './getColumnDefs';\nimport { xlsxToJson } from '../../../utils/xlsxToJson';\n\nimport SheetsSelector from '../SheetsSelector/SheetsSelector';\n\nimport CellValueInput from '../CellValueInput/CellValueInput';\nimport { useCellValue } from '../useCellValue.hook';\n\nfunction ExcelAgGrid({ workbook }) {\n    let [sheetName, setActiveSheetName] = useState(workbook.SheetNames[0]);\n    let [cellValue, onCellDataRequest] = useCellValue(workbook);\n    \n    let Sheet = useMemo(() => {\n        return workbook.Sheets[sheetName];\n    }, [workbook, sheetName]);\n    \n    let onSheetNameChange = useCallback((event) => {\n        let sheetName = event.target.name;\n        setActiveSheetName(sheetName);\n    }, [setActiveSheetName]);\n    \n    let rowData = useMemo(() => xlsxToJson(Sheet), [Sheet]);\n    let columnDefs = useMemo(() => getColumnDefs(rowData), [rowData]);\n    \n    return (\n    <div>\n        <h2>Ag-Grid Rendering version</h2>\n\n        <CellValueInput cellValue={cellValue} onCellDataRequest={onCellDataRequest} />\n\n        <SheetsSelector SheetNames={workbook.SheetNames} \n            onSheetNameChange={onSheetNameChange}\n            sheetName={sheetName}/>\n\n        <div className=\"excel-ag-grid-container ag-theme-alpine\">\n            <AgGridReact\n                defaultColDef={\n                    {width: 100}\n                }\n                columnDefs={columnDefs}\n                rowData={rowData}>   \n            </AgGridReact> \n        </div>\n    </div>\n    \n    );\n}\n\nexport default ExcelAgGrid;","import XLSX from 'xlsx';\n\nexport function xlsxToJson(Sheet) {\n    let options = {\n        raw: false,\n        header: 'A',\n        blankrows: false,\n        cellStyles: true,\n    }\n\n    return XLSX.utils.sheet_to_json(Sheet, options);\n}","import React, { useState, useCallback } from 'react';\n\nimport './WorkbookGrid.css';\n\nimport GridSelector from './GridSelector/GridSelector';\n\nimport ExcelXSpreadSheet from './x-spreadsheet/ExcelXSpreadSheet';\nimport ExcelAgGrid from './ag-grid/ExcelAgGrid';\n\nlet GridsEnum = {\n    XSpreadSheet: 'x-spreadsheet',\n    AgGrid: 'Ag-Grid',\n}\n\nlet gridOptions = [\n    {\n        name: GridsEnum.XSpreadSheet,\n        link: 'https://github.com/myliang/x-spreadsheet',\n    },\n    {\n        name: GridsEnum.AgGrid,\n        link: 'https://www.ag-grid.com',\n    }\n];\n\nfunction WorkBookGrid({ workbook }) {\n\n    let [selectedGridOptionName, selectGridOptionName] = useState(GridsEnum.XSpreadSheet);\n\n    let onGridOptionChange = useCallback((event) => {\n        selectGridOptionName(event.target.value);\n    }, [selectGridOptionName]);\n\n    return (\n    <div>\n        <GridSelector gridOptions={gridOptions} onGridOptionChange={onGridOptionChange} selectedGridOptionName={selectedGridOptionName} />\n        \n        {selectedGridOptionName === GridsEnum.AgGrid && <ExcelAgGrid workbook={workbook} />}\n        {selectedGridOptionName === GridsEnum.XSpreadSheet && <ExcelXSpreadSheet workbook={workbook} />}\n    </div>\n    );\n}\n\nexport default WorkBookGrid;","import React, { useCallback, useState } from 'react';\n\nimport XLSX from 'xlsx';\n\nimport './ExcelPreview.css';\nimport WorkbookGrid from '../WorkbookGrid/WorkbookGrid';\nimport { getColumnDefs } from '../WorkbookGrid/ag-grid/getColumnDefs';\n\nfunction ExcelPreview() {\n\n    let [workbook, setWorkbook] = useState(null);\n\n    let onFileChange = useCallback((event) => {\n        let files = event.target.files;\n        let [file] = files;\n        \n        let reader = new FileReader();\n        \n        reader.onload = function(event) {\n          let data = new Uint8Array(event.target.result);   \n          let workbook = XLSX.read(data, { type: 'array', cellStyles: true });\n\n          workbook.SheetNames.forEach((SheetName) => {\n              let sheetJSON = XLSX.utils.sheet_to_json(workbook.Sheets[SheetName], { raw: false, header: 'A', blankrows: false, cellStyles: true });\n              getColumnDefs(sheetJSON);\n          });\n\n          setWorkbook(workbook);\n        };\n        reader.readAsArrayBuffer(file);\n    }, [setWorkbook]);\n\n    return (\n    <div className=\"excel-preview\">\n        <p>We support: *.xls, *.xlsx, *.csv files. Please, chose some file for preview.</p>\n\n        <input onChange={onFileChange}\n            accept=\".csv, application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, application/vnd.ms-excel\"\n            className=\"excel-preview__input-file\" \n            type=\"file\" />\n        \n        {workbook && <WorkbookGrid workbook={workbook}/>}\n    </div>\n    );\n}\n\nexport default ExcelPreview;"],"sourceRoot":""}